# 📍 현장 부적합 입력 시스템 - 사용 가이드

## 🚀 설치 및 실행

### 1. 네이버 지도 API 키 발급

1. [네이버 클라우드 플랫폼](https://www.ncloud.com/) 접속
2. 회원가입 및 로그인
3. **Console > Services > AI·NAVER API > Maps** 선택
4. **Application 등록** 클릭
5. 애플리케이션 이름 입력 (예: gb-ud-portal)
6. **Web Dynamic Map** 선택
7. 서비스 URL 등록:
   - 개발: `http://localhost:5173`
   - 배포: 실제 도메인 주소
8. **등록** 클릭 후 **Client ID** 복사

### 2. 환경 변수 설정

`.env.local` 파일을 열어서 네이버 지도 API 키를 입력하세요:

```env
VITE_NAVER_MAP_CLIENT_ID=여기에_발급받은_Client_ID_붙여넣기
```

### 3. Supabase 테이블 생성

1. [Supabase Dashboard](https://supabase.com/dashboard) 접속
2. 프로젝트 선택
3. **SQL Editor** 메뉴 클릭
4. `supabase_field_reports.sql` 파일 내용 복사
5. SQL Editor에 붙여넣기
6. **Run** 버튼 클릭
7. "field_reports 테이블 생성 완료!" 메시지 확인

### 4. 개발 서버 실행

```bash
npm run dev
```

브라우저에서 `http://localhost:5173` 접속

---

## 📱 사용 방법

### 1. 로그인
- 지회 계정으로 로그인 (예: gb001 / gb001)

### 2. 현장 입력 화면 이동
- 메인 화면에서 **📍 현장 입력** 버튼 클릭

### 3. 위치 확인
- 브라우저 위치 권한 허용
- 현재 위치가 지도에 빨간 점으로 표시됨
- 지도를 클릭하면 해당 위치로 마커 이동
- **🎯 내 위치** 버튼을 눌러 현재 위치로 돌아가기

### 4. 부적합 항목 선택

#### 카테고리:
- **주차구역**: 주차구역 폭, 길이, 표지판, 바닥 표시
- **턱 낮추기**: 턱 높이, 유효폭, 경사도, 미설치
- **경사로**: 기울기, 유효폭, 손잡이
- **승강기**: 출입문 폭, 승강장 크기, 버튼 높이
- **화장실**: 출입문 폭, 활동 공간, 손잡이, 세면대
- **출입구**: 출입문 폭, 문턱 높이, 손잡이 높이

### 5. 측정값 입력
- 선택한 항목에 맞는 입력 필드가 나타남
- 숫자 입력 (단위 자동 표시)
- 메모 작성 (선택사항)

### 6. 저장
- **💾 저장** 버튼 클릭
- Supabase에 자동 저장됨
- 저장된 항목은 하단에 표시

---

## 🗺️ 지도 기능

### 지도 조작
- **드래그**: 지도 이동
- **스크롤**: 확대/축소
- **클릭**: 해당 위치로 마커 이동

### 주소 자동 변환
- 마커를 이동하면 자동으로 주소가 표시됨
- 도로명 주소 우선 표시
- 도로명 없을 경우 지번 주소 표시

---

## 📊 저장된 데이터 구조

```json
{
  "user_id": "gb001",
  "branch_id": 1,
  "category": "주차구역",
  "item_name": "주차구역 폭",
  "latitude": 37.5665,
  "longitude": 126.9780,
  "address": "서울특별시 중구 세종대로 110",
  "measurements": {
    "측정값": "180"
  },
  "memo": "주차선이 희미함",
  "created_at": "2025-12-31T10:30:00Z"
}
```

---

## 🔧 문제 해결

### 지도가 안 나와요
1. `.env.local` 파일에 네이버 지도 API 키가 제대로 입력되었는지 확인
2. 개발 서버 재시작 (`Ctrl+C` 후 `npm run dev`)
3. 브라우저 콘솔(F12)에서 에러 메시지 확인

### 위치 권한 오류
1. 브라우저 설정에서 위치 권한 허용
2. Chrome: 주소창 왼쪽 자물쇠 아이콘 > 위치 > 허용
3. HTTPS 환경에서만 위치 서비스 작동 (로컬은 예외)

### 저장이 안 돼요
1. Supabase 테이블이 생성되었는지 확인
2. `.env.local`의 Supabase 연결 정보 확인
3. 브라우저 콘솔에서 에러 메시지 확인

### 주소가 안 나와요
1. 네이버 지도 API에 **geocoder** 서브모듈이 포함되어 있는지 확인
2. 해외나 오지는 주소 변환이 안 될 수 있음
3. 이 경우 위도/경도만 표시됨

---

## 📈 향후 추가 예정 기능

- [ ] 📷 현장 사진 촬영 및 첨부
- [ ] 📄 한글 파일 자동 생성
- [ ] 📊 엑셀 파일 자동 생성
- [ ] 🔍 저장된 데이터 조회 및 수정
- [ ] 📤 일괄 내보내기
- [ ] 📍 지도에 저장된 위치 표시
- [ ] 🎨 부적합 유형별 색상 구분

---

## 📞 문의

문제가 발생하면 개발자에게 연락하세요.
